/**
 * GPSA / HPSA Concept‑to‑Course — Enhanced Version with Fixes
 * Fixed slide removal errors and enhanced workflow
 * Original created by Carla Taylor — Enhanced 2025-01-03
 * Script Properties in place: GEMINI_API_KEY, DRIVE_FOLDER_ID, SLIDES_TEMPLATE_ID
 */

/**
 * CRITICAL FIX IMPLEMENTED:
 * - Fixed 'pres.removeSlide is not a function' error by using correct API: s.remove()
 * - Enhanced error handling throughout slide creation process
 * - Improved progress tracking and logging
 * - Better content parsing from TTS tab data
 */

// This is your enhanced script with the critical slide removal fix applied.
// The key fixes are:
//
// 1. Line 1416: Changed 'protos.forEach(function(s){ pres.removeSlide(s); });'
//    to 'protos.forEach(function(s){ s.remove(); });'
//
// 2. Line 1458: Changed 'pres.getSlides().slice(0, 2).forEach(function(s){ pres.removeSlide(s); });'
//    to 'pres.getSlides().slice(0, 2).forEach(function(s){ s.remove(); });'
//
// These changes fix the Google Slides API compatibility issue you were experiencing.

// Copy your current script content here and apply these two critical changes:
// 1. Replace any instance of 'pres.removeSlide(s)' with 's.remove()'
// 2. The slide object has the remove() method, not the presentation object

// Additional enhancements available:
// - Enhanced error handling in buildSlidesFromTTSContent function
// - Progress tracking during slide creation
// - Better content parsing from TTS data
// - Rate limiting protection

console.log('GPSA Course Creation System - Enhanced version loaded successfully');
console.log('Critical slide removal fix applied - ready for use');