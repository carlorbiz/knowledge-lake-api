/**
 * UPDATED USER GUIDE WITH MODIFICATION REQUESTS
 * 
 * Complete user guide content that includes modification requests workflow
 */

function addHowToUseContent_(sheet) {
  const content = [
    ['ðŸŽ“ Concept-to-Course Tool - Complete User Guide', '', '', ''],
    ['', '', '', ''],
    ['GETTING STARTED', '', '', ''],
    ['', '', '', ''],
    ['This tool follows a proven workflow to transform your healthcare education', '', '', ''],
    ['concepts into complete, professional course materials with AI-powered', '', '', ''],
    ['content generation tailored for Australian standards.', '', '', ''],
    ['', '', '', ''],
    ['CHOOSE YOUR APPROACH', '', '', ''],
    ['', '', '', ''],
    ['ðŸš€ Course Creation Wizard (Recommended)', '', '', ''],
    ['â€¢ Guided step-by-step workflow for new users', '', '', ''],
    ['â€¢ Handles existing courses and modification requests automatically', '', '', ''],
    ['â€¢ Provides clear instructions and progress tracking', '', '', ''],
    ['â€¢ Best for first-time users and complex projects', '', '', ''],
    ['', '', '', ''],
    ['ðŸ“‹ Manual 10-Step Workflow (Advanced Users)', '', '', ''],
    ['â€¢ Full control over timing and customisation', '', '', ''],
    ['â€¢ Access individual functions as needed', '', '', ''],
    ['â€¢ Best for experienced users and specific tasks', '', '', ''],
    ['', '', '', ''],
    ['COMPLETE 10-STEP WORKFLOW', '', '', ''],
    ['', '', '', ''],
    ['SETUP & PLANNING', '', '', ''],
    ['', '', '', ''],
    ['Step 1: Setup & Add First Course', 'setupMappingTab', '', ''],
    ['â€¢ Creates the essential Mapping sheet for course project tracking', '', '', ''],
    ['â€¢ Sets up course concept, target audience, and Drive folder structure', '', '', ''],
    ['â€¢ Establishes workspace for course development', '', '', ''],
    ['â€¢ Configures sharing permissions and file organisation', '', '', ''],
    ['', '', '', ''],
    ['Step 2: Generate Course Recommendation', 'generateCourseRecommendation', '', ''],
    ['â€¢ AI analyses your source materials and generates course structure', '', '', ''],
    ['â€¢ Creates 8-12 modules with learning objectives and assessments', '', '', ''],
    ['â€¢ Applies Australian healthcare education standards (RACGP/ACRRM)', '', '', ''],
    ['â€¢ HANDLES MODIFICATION REQUESTS: If Column F has requests, creates', '', '', ''],
    ['  revised recommendation incorporating your specific changes', '', '', ''],
    ['â€¢ TIP: To modify existing recommendations, enter requests in Column F', '', '', ''],
    ['  then run this step again for automatic revision processing', '', '', ''],
    ['', '', '', ''],
    ['Step 3: Create Content Tabs & Subfolders', 'createCourseContentTabs', '', ''],
    ['â€¢ Creates organised worksheet tabs for each course module', '', '', ''],
    ['â€¢ Sets up corresponding Drive subfolders for file management', '', '', ''],
    ['â€¢ Establishes Module-Resources sheets for content tracking', '', '', ''],
    ['â€¢ Prepares TTS worksheets for audio content management', '', '', ''],
    ['', '', '', ''],
    ['CONTENT CREATION', '', '', ''],
    ['', '', '', ''],
    ['Step 4: Generate Full Suite of Resources', 'generateFullSuiteOfResources', '', ''],
    ['â€¢ Creates comprehensive learning materials for all modules', '', '', ''],
    ['â€¢ Generates detailed content, case studies, and practical exercises', '', '', ''],
    ['â€¢ Produces materials suitable for various learning modalities', '', '', ''],
    ['â€¢ Ensures alignment with selected target audience requirements', '', '', ''],
    ['', '', '', ''],
    ['Step 5: Generate Absorb LMS Upload Doc', 'generateAbsorbLmsFile', '', ''],
    ['â€¢ Creates LMS-ready documentation for course deployment', '', '', ''],
    ['â€¢ Formats content according to Absorb LMS specifications', '', '', ''],
    ['â€¢ Includes metadata, structure, and assessment configurations', '', '', ''],
    ['â€¢ Streamlines the learning management system upload process', '', '', ''],
    ['', '', '', ''],
    ['SLIDES & AUDIO PRODUCTION', '', '', ''],
    ['', '', '', ''],
    ['Step 6: Generate Slides for Module', 'generateSlidesForSelectedModule', '', ''],
    ['â€¢ Creates professional PowerPoint presentations for each module', '', '', ''],
    ['â€¢ Uses your designated slides template for brand consistency', '', '', ''],
    ['â€¢ Includes speaker notes and visual content suggestions', '', '', ''],
    ['â€¢ Optimised for healthcare education delivery and engagement', '', '', ''],
    ['', '', '', ''],
    ['Step 7: Set TTS Voice', 'setTtsVoice_', '', ''],
    ['â€¢ Configures text-to-speech voice preferences and parameters', '', '', ''],
    ['â€¢ Allows selection of appropriate voice characteristics', '', '', ''],
    ['â€¢ Sets consistent parameters for professional audio generation', '', '', ''],
    ['â€¢ Prepares system for efficient bulk audio production', '', '', ''],
    ['', '', '', ''],
    ['Step 8: Generate All Audio for Module', 'generateAllAudioForModule', '', ''],
    ['â€¢ Creates professional text-to-speech audio for module content', '', '', ''],
    ['â€¢ Processes slide scripts, narration text, and learning materials', '', '', ''],
    ['â€¢ Generates consistent, high-quality audio files', '', '', ''],
    ['â€¢ Organises audio assets for seamless course delivery', '', '', ''],
    ['', '', '', ''],
    ['DATA & ARCHIVAL', '', '', ''],
    ['', '', '', ''],
    ['Step 9: Clean Module Audio Files', 'cleanModuleAudioFiles', '', ''],
    ['â€¢ Reviews and optimises generated audio assets', '', '', ''],
    ['â€¢ Removes temporary, duplicate, or unused audio files', '', '', ''],
    ['â€¢ Organises final file structure for professional delivery', '', '', ''],
    ['â€¢ Prepares audio components for course archiving', '', '', ''],
    ['', '', '', ''],
    ['Step 10: Archive Course Project', 'archiveCourse', '', ''],
    ['â€¢ Safely archives completed course materials and resources', '', '', ''],
    ['â€¢ Creates comprehensive backup copies of all course assets', '', '', ''],
    ['â€¢ Organises final deliverables for future reference and updates', '', '', ''],
    ['â€¢ Completes the full course development lifecycle', '', '', ''],
    ['', '', '', ''],
    ['MODIFICATION REQUESTS WORKFLOW', '', '', ''],
    ['', '', '', ''],
    ['The tool includes powerful revision capabilities for continuous improvement:', '', '', ''],
    ['', '', '', ''],
    ['How to Request Modifications:', '', '', ''],
    ['1. Review your generated course recommendation document', '', '', ''],
    ['2. Enter specific modification requests in Column F (Mapping sheet)', '', '', ''],
    ['3. Run "Step 2: Generate Course Recommendation" again', '', '', ''],
    ['4. System automatically detects modification requests', '', '', ''],
    ['5. Choose to create revised recommendation incorporating changes', '', '', ''],
    ['', '', '', ''],
    ['Example Modification Requests:', '', '', ''],
    ['â€¢ "Include minimum 10 references in citations section"', '', '', ''],
    ['â€¢ "Add more practical case studies to modules 3-5"', '', '', ''],
    ['â€¢ "Expand assessment rubrics with detailed criteria"', '', '', ''],
    ['â€¢ "Include communication skills module for difficult conversations"', '', '', ''],
    ['â€¢ "Add more rural and remote context examples"', '', '', ''],
    ['â€¢ "Ensure cultural safety principles throughout all modules"', '', '', ''],
    ['', '', '', ''],
    ['Revision Process:', '', '', ''],
    ['â€¢ Original recommendation document is preserved', '', '', ''],
    ['â€¢ Revised document created with "_REVISED" suffix', '', '', ''],
    ['â€¢ AI incorporates specific requests while maintaining quality', '', '', ''],
    ['â€¢ Option to clear modification requests after processing', '', '', ''],
    ['â€¢ Multiple revision cycles supported for iterative improvement', '', '', ''],
    ['', '', '', ''],
    ['MAPPING SHEET STRUCTURE', '', '', ''],
    ['', '', '', ''],
    ['Your Mapping sheet columns (A-T) track complete course development:', '', '', ''],
    ['', '', '', ''],
    ['A: Course Concept - Your course topic or focus area', '', '', ''],
    ['B: Resources Folder Link - Google Drive folder with source materials', '', '', ''],
    ['C: Target Audience - Dropdown selection (Clinical/Combined/Administrative/Other)', '', '', ''],
    ['D: Recommendation - Link to AI-generated course structure document', '', '', ''],
    ['E: Approved - Checkbox to confirm recommendation approval', '', '', ''],
    ['F: Modification Requests - Your specific revision requirements', '', '', ''],
    ['G: Module List - Summary of generated course modules', '', '', ''],
    ['H-S: Individual Module Names - Specific module titles (Module 1-12)', '', '', ''],
    ['T: Course Drive Folder - Final project folder for all course materials', '', '', ''],
    ['', '', '', ''],
    ['SOURCE MATERIALS SETUP', '', '', ''],
    ['', '', '', ''],
    ['For optimal AI analysis and course generation:', '', '', ''],
    ['', '', '', ''],
    ['B2 Main Resource Folder:', '', '', ''],
    ['â€¢ Link to Google Drive folder containing your primary source materials', '', '', ''],
    ['â€¢ Can include PDFs, Google Docs, and other educational resources', '', '', ''],
    ['â€¢ System processes all files including subfolders automatically', '', '', ''],
    ['', '', '', ''],
    ['B3+ Additional Resources:', '', '', ''], 
    ['â€¢ Individual file links, additional folders, or web URLs', '', '', ''],
    ['â€¢ Each row (B3, B4, B5, etc.) can contain different resource types', '', '', ''],
    ['â€¢ Supports Google Docs, PDFs, Drive folders, and external websites', '', '', ''],
    ['', '', '', ''],
    ['Sharing Permissions Important:', '', '', ''],
    ['â€¢ Ensure all source files/folders are set to "Anyone with the link"', '', '', ''],
    ['â€¢ If access issues occur, download files to device and upload to B2 folder', '', '', ''], 
    ['â€¢ This prevents permission-related processing errors', '', '', ''],
    ['', '', '', ''],
    ['SYSTEM REQUIREMENTS', '', '', ''],
    ['', '', '', ''],
    ['Your administrator must configure these system components:', '', '', ''],
    ['â€¢ Gemini AI API credentials for intelligent content generation', '', '', ''],
    ['â€¢ Google Drive folder permissions and organisational structure', '', '', ''],
    ['â€¢ PowerPoint template access for consistent slide formatting', '', '', ''],
    ['â€¢ Text-to-speech API configuration for audio generation', '', '', ''],
    ['', '', '', ''],
    ['BEST PRACTICES', '', '', ''],
    ['', '', '', ''],
    ['Course Development Workflow:', '', '', ''],
    ['â€¢ Start each new course with Step 1 for proper foundation setup', '', '', ''],
    ['â€¢ Follow steps sequentially for optimal workflow efficiency', '', '', ''],
    ['â€¢ Use the Course Creation Wizard for guided experience', '', '', ''],
    ['â€¢ Review and customise all AI-generated content before finalising', '', '', ''],
    ['', '', '', ''],
    ['Quality Assurance:', '', '', ''],
    ['â€¢ Always review recommendation documents thoroughly', '', '', ''],
    ['â€¢ Use modification requests for iterative improvement', '', '', ''],
    ['â€¢ Test audio output quality before bulk generation', '', '', ''],
    ['â€¢ Maintain organised source materials and references', '', '', ''],
    ['â€¢ Ensure all content meets Australian healthcare standards', '', '', ''],
    ['', '', '', ''],
    ['AUSTRALIAN HEALTHCARE STANDARDS', '', '', ''],
    ['', '', '', ''],
    ['This tool is specifically designed for Australian healthcare education:', '', '', ''],
    ['â€¢ Incorporates RACGP and ACRRM educational guidelines', '', '', ''],
    ['â€¢ Applies Australian clinical practice standards and protocols', '', '', ''],
    ['â€¢ Supports CPD requirements and learning objective frameworks', '', '', ''],
    ['â€¢ Emphasises cultural safety and inclusive education principles', '', '', ''],
    ['â€¢ Uses Vancouver referencing style for academic citations', '', '', ''],
    ['â€¢ Includes rural and remote healthcare context considerations', '', '', ''],
    ['', '', '', ''],
    ['TROUBLESHOOTING', '', '', ''],
    ['', '', '', ''],
    ['Common Issues and Solutions:', '', '', ''],
    ['', '', '', ''],
    ['File Access Problems:', '', '', ''],
    ['â€¢ Error: "The document is inaccessible"', '', '', ''],
    ['â€¢ Solution: Check sharing permissions are set to "Anyone with the link"', '', '', ''],
    ['â€¢ Alternative: Download files and upload to course project folder', '', '', ''],
    ['', '', '', ''],
    ['PDF Processing Issues:', '', '', ''],
    ['â€¢ Modern system uses Gemini AI for direct PDF processing', '', '', ''],
    ['â€¢ No conversion errors - PDFs sent directly to AI for analysis', '', '', ''],
    ['â€¢ If issues persist, ensure PDFs are not corrupted or password-protected', '', '', ''],
    ['', '', '', ''],
    ['Modification Requests Not Working:', '', '', ''],
    ['â€¢ Ensure Column F contains specific, clear modification requests', '', '', ''],
    ['â€¢ Run "Step 2: Generate Course Recommendation" (not other functions)', '', '', ''],
    ['â€¢ System automatically detects and processes modification requests', '', '', ''],
    ['', '', '', ''],
    ['Course Creation Wizard Issues:', '', '', ''],
    ['â€¢ Ensure you have proper system permissions and API access', '', '', ''],
    ['â€¢ Contact administrator if system configuration alerts appear', '', '', ''],
    ['â€¢ Use individual menu functions as alternative to wizard', '', '', ''],
    ['', '', '', ''],
    ['GETTING HELP', '', '', ''],
    ['', '', '', ''],
    ['For assistance and support:', '', '', ''],
    ['â€¢ Review this complete user guide thoroughly before starting', '', '', ''],
    ['â€¢ Use the Course Creation Wizard for guided experience', '', '', ''],
    ['â€¢ Check system status using built-in diagnostic functions', '', '', ''],
    ['â€¢ Contact your system administrator for API or permission issues', '', '', ''],
    ['â€¢ Refer to GPSA documentation for educational standards compliance', '', '', ''],
    ['â€¢ Use modification requests for iterative course improvement', '', '', ''],
    ['', '', '', ''],
    ['SUPPORT RESOURCES', '', '', ''],
    ['', '', '', ''],
    ['Educational Standards:', '', '', ''],
    ['â€¢ RACGP Curriculum and Professional Development Guidelines', '', '', ''],
    ['â€¢ ACRRM Professional Development Program Requirements', '', '', ''],
    ['â€¢ AHPRA Continuing Professional Development Standards', '', '', ''],
    ['', '', '', ''],
    ['Technical Support:', '', '', ''],
    ['â€¢ Google Apps Script documentation for advanced customisation', '', '', ''],
    ['â€¢ Gemini AI API documentation for content generation features', '', '', ''],
    ['â€¢ Google Drive API documentation for file management capabilities', '', '', ''],
    ['', '', '', ''],
    ['This comprehensive tool empowers you to create professional,', '', '', ''],
    ['standards-compliant healthcare education courses efficiently', '', '', ''],
    ['while maintaining the highest quality and educational effectiveness.', '', '', '']
  ];
  
  // Write content to sheet
  if (content.length > 0) {
    sheet.getRange(1, 1, content.length, 4).setValues(content);
  }
}