# AUDIO TAB COMPLETE - INSTALLATION GUIDE

## ğŸ¯ WHAT THIS SCRIPT DOES

**Completely replaces n8n Workflow 4** with Google Apps Script + Google Sheets:

âœ… **Audio Generation** - Gemini TTS (30 voices: Charon, Aoede, Kore, etc.)
âœ… **Image Generation** - Imagen 3 via Gemini API
âœ… **Presentation Creation** - Google Slides from Audio tab data
âœ… **Male/Female Adaptive Prompts** - Voice prompts adapt to voice gender
âœ… **Rate Limiting** - Prevents API crashes from concurrent requests
âœ… **No n8n Connection** - 100% Google ecosystem

---

## ğŸ“‹ REQUIREMENTS

1. **Google Sheet** with "Audio" tab
2. **Gemini API Key** from https://aistudio.google.com/apikey
3. **Google Apps Script** access (built into Google Sheets)

---

## ğŸš€ INSTALLATION (5 MINUTES)

### Step 1: Open Apps Script Editor

1. Open your Google Sheet
2. Click **Extensions** â†’ **Apps Script**
3. Delete any existing code in `Code.gs`

### Step 2: Copy Script

1. Open `Audio_Tab_Complete.gs` (this directory)
2. Copy ALL code
3. Paste into Apps Script editor
4. Click **Save** (ğŸ’¾ icon)

### Step 3: Configure Script Properties (IMPORTANT!)

**The script uses Script Properties for secure configuration.**

1. In Apps Script editor, click **Project Settings** (âš™ï¸ icon on left)
2. Scroll to **Script Properties** section
3. Click **Add script property**
4. Add **required property**:
   - Property: `GEMINI_API_KEY`
   - Value: Your Gemini API key from https://aistudio.google.com/apikey
5. Click **Save script properties**
6. **(Optional but recommended)** Add more properties:
   - `DRIVE_FOLDER_ID` - Google Drive folder ID for organized file storage
   - `VOICE_NAME_OVERRIDE` - Default voice (e.g., "Charon", "Aoede")

**See `SCRIPT_PROPERTIES_SETUP.md` for detailed setup guide.**

### Step 4: Authorize Script

1. Click **Run** â†’ Select `onOpen`
2. Click **Review permissions**
3. Choose your Google account
4. Click **Advanced** â†’ **Go to [Your Project] (unsafe)**
5. Click **Allow**

### Step 5: Reload Sheet

1. Close Apps Script editor
2. Refresh your Google Sheet
3. You should see new menu: **ğŸ™ï¸ Audio Generation**

---

## ğŸ¤ VOICE OPTIONS (30 GEMINI VOICES)

### ğŸ‘© FEMALE VOICES (Recommended for Healthcare)
- **Aoede** - Breezy, professional
- **Callirrhoe** - Easy-going
- **Autonoe** - Bright, clear
- **Despina** - Smooth professional
- **Sulafat** - Warm, engaging
- **Vindemiatrix** - Gentle professional

### ğŸ‘¨ MALE VOICES (Recommended for Healthcare)
- **Charon** - Informative (BEST for Australian healthcare) â­
- **Kore** - Firm professional
- **Gacrux** - Mature, experienced
- **Sadaltager** - Knowledgeable expert
- **Rasalgethi** - Informative
- **Alnilam** - Firm authoritative

### âš¡ NEUTRAL VOICES
- **Zephyr** - Bright, versatile
- **Puck** - Upbeat, engaging

**Full list:** Click **ğŸ“‹ Show Available Voices** in menu

---

## ğŸ“Š COLUMN STRUCTURE (Audio Tab)

Your "Audio" tab must have these columns (in order):

| Col | Name | Description |
|-----|------|-------------|
| A | Slide # | Slide number (1, 2, 3...) |
| B | Voiceover Script | âœ¨ Generated from R (or manual) |
| C | Audio File | âœ¨ Generated by script |
| D | Image Prompt | âœ¨ Generated from R (or manual) |
| E | Image File | âœ¨ Generated by script |
| F | Course ID | Course identifier |
| G | Module Number | Module number (1-12) |
| H | Slide Number | Slide number within module |
| I | Module Title | Module name |
| J | Course Title | Course name |
| K | Target Audience | Healthcare Clinical, etc. |
| L | Slide Title | Title of slide |
| M | Content Points | âœ¨ Generated from R (JSON array) |
| N | Timestamp | Row creation timestamp |
| O | Status | Next, Pending, Content Enhanced, Complete |
| P | Voice Selection | Voice name (Charon, Aoede, etc.) |
| Q | Slides (PPT-ready) | âœ¨ Presentation URL |
| R | Raw Slide Content | **USER INPUT** - Basic text to enhance |

**NEW: Column R (Raw Slide Content)** - Start here with basic text!

---

## ğŸ¯ HOW TO USE

### NEW: Two Workflow Options

**OPTION 1: Start from Basic Text (Column R)**
1. Fill Column R with basic text notes
2. Menu â†’ ğŸš€ STEP 1: Enhance Content
3. Review generated B, D, M columns
4. Menu â†’ â–¶ï¸ STEP 2: Generate Audio/Images
5. Done!

**OPTION 2: Start from Pre-Enhanced Content (n8n Workflow 3)**
1. n8n populates Columns B, D, M
2. Menu â†’ â–¶ï¸ STEP 2: Generate Audio/Images
3. Done!

**QUICK START: Full Auto Pipeline**
- Fill Column R â†’ Menu â†’ âš¡ AUTO: Full Pipeline â†’ Done!

---

### Enhance Content (NEW - STEP 1)

1. **Fill Column R** with basic text (e.g., "Discuss medication safety protocols...")
2. **Select rows** in Audio tab
3. **Click menu:** ğŸ™ï¸ Audio Generation â†’ ğŸš€ STEP 1: Enhance Content
4. **Wait:** ~3 seconds per slide
5. **Result:** Columns B (Voiceover Script), D (Image Prompt), M (Content Points) populated

### Generate Audio (STEP 2)

1. **Select rows** in Audio tab (with Column B filled)
2. **Click menu:** ğŸ™ï¸ Audio Generation â†’ â–¶ï¸ STEP 2: Generate Audio for Selected Slides
3. **Wait:** ~3 seconds per slide
4. **Result:** Audio File column (C) populated with Google Drive URLs

### Generate Images (STEP 2)

1. **Select rows** with Column D (Image Prompt) filled in
2. **Click menu:** ğŸ™ï¸ Audio Generation â†’ ğŸ¨ STEP 2: Generate Images for Selected Slides
3. **Wait:** ~3 seconds per slide
4. **Result:** Image File column (E) populated with image URLs

### Full Auto Pipeline (NEW - ALL STEPS AT ONCE)

1. **Fill Column R** with basic text
2. **Select rows**
3. **Click menu:** ğŸ™ï¸ Audio Generation â†’ âš¡ AUTO: Enhance + Audio + Images (Full Pipeline)
4. **Wait:** ~10-15 seconds per slide
5. **Result:** Columns B, D, M, C, E all populated automatically!

### Create Presentation (STEP 3)

1. **Select slides** to include in presentation
2. **Click menu:** ğŸ™ï¸ Audio Generation â†’ ğŸ“Š Generate Presentation from Selected Slides
3. **Result:** Google Slides presentation created, URL in column Q

### Set Voice

1. **Select rows**
2. **Click menu:** ğŸ™ï¸ Audio Generation â†’ ğŸ¤ Set Voice for Selected Slides
3. **Enter voice name:** e.g., "Charon" or "Aoede"
4. **Result:** Voice Selection column (P) updated

---

## âš™ï¸ ADVANCED FEATURES

### Male/Female Adaptive Prompts

The script **automatically detects voice gender** and uses appropriate prompts:

- **Female voices:** "You are a highly experienced Australian female healthcare educator..."
- **Male voices:** "You are a highly experienced Australian male healthcare educator..."
- **Neutral voices:** Gender-neutral professional prompt

### Rate Limiting

To prevent API crashes:
- **2 seconds** between API calls
- **3 seconds** between slides in batch
- **1 concurrent request** at a time (sequential processing)

### API Quota Monitoring

If you hit quota limits:
1. Increase delays: Edit CONFIG.DELAY_BETWEEN_REQUESTS (line 52)
2. Process fewer slides per batch
3. Wait 60 seconds between batches

---

## ğŸ” TROUBLESHOOTING

### "Audio generation failed"
- **Check API key:** Must be valid Gemini API key
- **Check quota:** Visit https://aistudio.google.com/apikey
- **Check script:** Column B (Voiceover Script) must have text

### "Image generation failed"
- **Check prompt:** Column D (Image Prompt) must have text
- **Check quota:** Imagen uses same API key quota
- **Try again:** Sometimes fails randomly, retry works

### "Invalid voice name"
- **Check spelling:** Voice names are case-sensitive
- **Use menu:** Click "ğŸ“‹ Show Available Voices" for exact names
- **Recommended:** Charon, Aoede, Gacrux

### "Script timeout"
- **Process fewer slides:** Select 5-10 slides at a time
- **Increase timeout:** Not possible in Apps Script (6 min max)
- **Use batch mode:** Runs more efficiently

---

## ğŸ“ˆ PERFORMANCE

### Single Slide:
- Audio generation: ~3-5 seconds
- Image generation: ~3-5 seconds
- Total (both): ~8-10 seconds

### Batch Processing:
- 10 slides audio only: ~30-40 seconds
- 10 slides images only: ~30-40 seconds
- 10 slides audio + images: ~60-80 seconds

### Apps Script Limits:
- **Max execution time:** 6 minutes
- **Max slides per batch:** ~30-40 (audio + images)
- **Solution:** Process in smaller batches

---

## ğŸ“ RECOMMENDED WORKFLOW

### For 12-Slide Module:

1. **Populate data** (from n8n Workflow 3 or manual entry)
2. **Set voices:**
   - Select all 12 rows
   - Menu â†’ Set Voice for Selected Slides
   - Enter: "Charon" (or preferred voice)

3. **Generate batch:**
   - Select all 12 rows
   - Menu â†’ Generate Audio + Images (Batch)
   - Wait ~2 minutes

4. **Create presentation:**
   - Select all 12 rows
   - Menu â†’ Generate Presentation from Selected Slides
   - Opens in new tab

5. **Done!** All columns populated, presentation ready

---

## ğŸ” SECURITY NOTES

- **API Key:** Never share your Gemini API key
- **Drive Files:** Audio/image files are set to "Anyone with link"
- **Script Access:** Only you can run the script (unless shared)
- **Quota:** Free tier = 60 requests/minute (should be sufficient)

---

## ğŸ’¡ TIPS

1. **Use Charon voice** for Australian healthcare (tested, professional)
2. **Process 10 slides at a time** for optimal performance
3. **Check Status column** to track which slides are complete
4. **Rerun if needed** - script is idempotent (safe to rerun)
5. **Create Drive folders** - Audio/images saved to "Course Audio Files" and "Course Image Files"

---

## ğŸš¨ IMPORTANT NOTES

### GEMINI VOICES ONLY
This script uses **Gemini Generative Language API voices** (Charon, Kore, Aoede, etc.) - NOT Google Cloud TTS voices. These voices have been adapted to Australian accent.

### NO n8n CONNECTION
This is a **standalone solution** - no connection to n8n workflows. Use this instead of Workflow 4.

### VERTEX AI (Future)
Script includes notes on migrating to Vertex AI for:
- Higher quotas
- Better monitoring
- Enterprise features

For now, direct Gemini API is simpler and works great.

---

## ğŸ“ SUPPORT

**Check logs:**
1. Apps Script editor â†’ **View** â†’ **Logs**
2. Look for error messages

**Common issues:**
- 99% are API key or quota problems
- Check https://aistudio.google.com/apikey for usage

**Script updates:**
- Replace code in Apps Script editor
- Save and reload sheet

---

*Audio Tab Complete - Google Apps Script*
*Replaces n8n Workflow 4*
*Date: 2025-10-07*
*Status: PRODUCTION READY* âœ…
