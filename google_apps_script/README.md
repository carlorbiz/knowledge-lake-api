# Google Apps Script - Course Development System

**Version:** 1.0 - HPSA Production Release
**Last Updated:** 2025-10-10
**Status:** ‚úÖ Production Ready
**Developer:** Carlorbiz for GPSA/HPSA

---

## üéØ HPSA PRODUCTION RELEASE

This is the complete **Concept-to-Course** workflow developed by Carlorbiz for GPSA (General Practice Supervisors Australia) and deployed for HPSA (Healthcare Professionals Support Australia).

**See:** `HPSA/` subfolder for production scripts and documentation

---

## üìö ACTIVE SCRIPTS

### **1. Module_Content_Generator.gs**
**Purpose:** Automated module content generation with hybrid quality control
**Status:** ‚úÖ Production Ready
**Location:** Main folder + `HPSA/` backup

**Features:**
- Pure Google stack (Gemini API only)
- **Hybrid workflow:** Manual research (Gems/NotebookLM) ‚Üí Automated content generation
- Generates 12 slides with rich 80-120 word detailed content per slide
- Creates LMS upload document (Absorb AI compatible with exactly 12 screen structure)
- Generates premium workbook materials with glossary, templates, resources
- Creates 2-3 detailed case studies per module
- Produces assessments (10 MCQs + 3 role-play scenarios) with iSpring audio scripts
- **Australian spelling enforcement** in all Gemini prompts
- **Citations support** (Column M in Module Queue) - separate from Research Notes to avoid character limits
- Writes to Audio tab with Status="Pending" for enhancement

**Recent Enhancements (2025-10-10):**
- ‚úÖ Australian spelling enforcement across ALL prompts (organize‚Üíorganise, etc.)
- ‚úÖ Citations column integration (Column M) - preserved full text via array formulas
- ‚úÖ Research foundation split (Research + Citations) for character limit handling
- ‚úÖ Module Content Complete uses array formulas to preserve full research
- ‚úÖ Bullet points simplified to 5-10 words max for better readability
- ‚úÖ Absorb LMS AI compatibility with 12-screen structure

---

### **2. Audio_Tab_Enhanced.gs**
**Purpose:** Slide enhancement, audio generation, and LMS upload creation
**Status:** ‚úÖ Production Ready
**Location:** Main folder + `HPSA/` backup

**Features:**
- **LMS Upload Generation** (NEW): Creates ProvenLMSlayout.txt format documents
- Reads from individual Module tabs (Module 1, Module 2, etc.)
- Uses Slides JSON (Column X) for bullet points
- Uses Raw Slide Content (Column R) for voiceover context
- **NO phonetic spellings** in LMS upload (clean for Absorb parsing)
- **Australian spelling enforcement** with 60+ US‚ÜíAU replacements
- Saves LMS Upload URL to Column Y automatically
- Gemini TTS audio generation with 30 professional voices
- Phonetic replacements for TTS only (ACRRM ‚Üí "Ackr'm", NMBA ‚Üí "N.M.B.A.")
- Professional Australian voice prompts
- Status-based workflows

**LMS Upload Feature (2025-10-10):**
```
Slide 1: [Title]
- [bullet point 1]
- [bullet point 2]
- [bullet point 3]

Voiceover:
"[1-2 sentence summary for LMS context]"

---
```

**Data Flow:**
- Slide Title: Column L (Slide Title from Audio tab rows 2-13)
- Bullet Points: Column M (Content Points JSON from Audio tab rows 2-13)
- Voiceover Summary: Column X (Slides JSON detailedContent - 1-2 sentences extracted)

**Key Innovation:**
- Separates LMS upload text (clean, no phonetics) from TTS voiceover (with phonetics)
- Ensures Absorb LMS AI doesn't get confused by ACRRM, N.M.B.A., etc.
- Your uploaded audio files align perfectly with LMS-generated slides

---

## üìã ACTIVE DOCUMENTATION

### **Core Documentation**
- **`README.md`** - This file (main overview)
- **`HPSA/README.md`** - Production release documentation
- **`CHANGELOG.md`** - Version history and changes
- **`Complete_Course_Development_Workflow.txt`** - Full workflow specification

### **Setup Guides**
- **`AUDIO_TAB_INSTALLATION.md`** - Audio_Tab_Enhanced.gs installation
- **`SCRIPT_PROPERTIES_SETUP.md`** - API keys and configuration
- **`STATUS_WORKFLOW_GUIDE.md`** - Status-based automation

### **Reference**
- **`USER_GUIDE_QUICK_START.md`** - Quick start for end users
- **`Quick_Reference_All_Prompts_&_Templates.txt`** - Prompt library
- **`ProvenLMSlayout.txt`** - LMS upload format template

---

## üóÇÔ∏è COLUMN STRUCTURE

### **Module Queue Sheet**
| Column | Name | Purpose |
|--------|------|---------|
| A | Module Number | Unique identifier |
| B | Module Title | Module name |
| C | Audience Type | Healthcare Clinical/Administrative/Combined |
| D | Learning Objectives | Module objectives |
| E | Core Content Focus | Key topics |
| F | Research Notes | Full research body (2500-3500 words) |
| M | Citations | Vancouver style citations (separate for character limits) |
| Status | Status | Next ‚Üí Content Generated |
| Last Updated | Last Updated | Timestamp |

### **Audio Tab (Master Workbook)**
| Column | Name | Purpose |
|--------|------|---------|
| A | Slide # | 1-12 |
| B | Voiceover Script | Generated by Audio tab (WITH phonetics for TTS) |
| C | Audio File | Google Drive URL |
| D | Image Prompt | Generated by Audio tab |
| E | Image File | (Optional) |
| F | Course ID | (Optional) |
| G | Module Number | Links to Module Queue |
| H | Slide Number | 1-12 |
| I | Module Title | Module name |
| J | Course Title | (Optional) |
| K | Target Audience | Audience type |
| L | Slide Title | Slide heading |
| M | Content Points | JSON array of bullet points |
| N | Timestamp | Last updated |
| O | Status | Pending ‚Üí Content Enhanced ‚Üí Audio Generated |
| P | Voice Selection | Gemini TTS voice name |
| Q | Slides PPT | (Optional) |
| R | Raw Slide Content | SOURCE - detailedContent from Module Generator |

### **Module Content Complete Sheet**
| Column | Name | Purpose |
|--------|------|---------|
| A | Module Number | Unique identifier |
| B | Module Title | Module name |
| C | Citations | Full citations (array formula from Module Queue Col M) |
| D | Learning Objectives | Module objectives |
| E | Research Summary | Full research (array formula from Module Queue Col F) |
| F | Slides JSON | All 12 slides in JSON |
| G | LMS Document | Markdown LMS upload |
| H | Workbook Materials | Premium workbook |
| I | MCQs JSON | 10 assessment questions |
| J | Role-Play Scenarios JSON | 3 scenarios |
| Generated Date | Generated Date | Timestamp |
| Audio Tab Link | Audio Tab Link | Hyperlink to Audio tab range |

**Array Formula Example (Column E - Research Summary):**
```
={"Research Summary";ARRAYFORMULA(IF(A2:A="","",VLOOKUP(A2:A,'Module Queue'!A:F,6,FALSE)))}
```

---

## üîÑ COMPLETE WORKFLOW

```
1. RESEARCH (Manual - Quality Control)
   ‚Üì
   User conducts research via:
   - Gems (web-based AI research)
   - NotebookLM (Drive source analysis)
   - Manual curation
   Pastes into Module Queue:
   - Research Notes (Column F)
   - Citations (Column M)

2. CONTENT GENERATION (Automated)
   ‚Üì
   Module_Content_Generator.gs
   - Generates 12 slides (80-120 words/slide)
   - Creates LMS upload (Markdown, 12-screen structure)
   - Creates workbook + case studies
   - Creates assessments + audio scripts
   - Australian spelling enforced in prompts
   - Writes to Audio tab (Status: Pending)
   - Saves to Module Content Complete

3. AUDIO ENHANCEMENT (Automated)
   ‚Üì
   Audio_Tab_Enhanced.gs
   - Reads Column R (Raw Slide Content)
   - Generates:
     * Content Points (4-6 bullets)
     * Voiceover Script (150-225 words WITH phonetics)
     * Image Prompt
   - Status: Content Enhanced

4. AUDIO GENERATION (Automated)
   ‚Üì
   Audio_Tab_Enhanced.gs
   - Reads Column B (voiceover with phonetics)
   - Generates audio with Gemini TTS
   - Uploads to Google Drive
   - Status: Audio Generated

5. LMS UPLOAD CREATION (Automated)
   ‚Üì
   Audio_Tab_Enhanced.gs
   - Go to Module tab (Module 1, Module 2, etc.)
   - Run: üéôÔ∏è Audio Generation ‚Üí üìÑ Generate LMS Upload
   - Reads from rows 2-13:
     * Column L: Slide Title
     * Column M: Content Points (JSON array for bullets)
     * Column X: Slides JSON detailedContent (for voiceover summaries)
   - Creates ProvenLMSlayout.txt format
   - NO phonetics (clean for LMS parsing)
   - Australian spelling enforced
   - Saves URL to Column Y

6. ABSORB LMS DEPLOYMENT (Manual)
   ‚Üì
   - Upload LMS document to Absorb
   - Absorb AI creates 12 screens
   - Upload audio files to each screen
   - Publish course
```

---

## üéØ KEY DESIGN DECISIONS

### **Hybrid Quality Control**
- **Manual research** ensures expertise and accuracy
- **Automated content generation** ensures consistency and efficiency
- **Human review** at LMS upload stage before publishing

### **Australian Healthcare Focus**
- AHPRA, NMBA, NSQHS standards compliance
- **Australian spelling throughout** (organise, colour, favour, centre, analyse, practise, emphasise)
- Professional tone for experienced practitioners
- Evidence-based content with Vancouver citations

### **LMS Upload Innovation**
- **Separates concerns:** LMS text (clean) vs TTS voiceover (phonetic)
- **ProvenLMSlayout.txt format:** Simple, proven to work with Absorb
- **No phonetic confusion:** ACRRM stays "ACRRM" (not "Ackr'm") in LMS upload
- **Audio alignment:** Your audio files match LMS slides perfectly

### **Pure Google Stack**
- Gemini API for all AI operations
- Google Drive for file storage
- Google Sheets for data management
- No external AI services (Anthropic, OpenAI, etc.)

### **Research Foundation Management**
- **Split storage:** Research (Col F) + Citations (Col M) avoids character limits
- **Array formulas:** Module Content Complete preserves full text dynamically
- **Full AI access:** Generation uses complete research, not truncated versions

---

## üì¶ ARCHIVED

**Location:** `archive_2025-10-08/`

Superseded files:
- Audio_Tab_Complete.gs (replaced by Audio_Tab_Enhanced.gs)
- MODULE_GENERATOR_REVIEW.md (enhancements completed)
- CONTENT_ENHANCEMENT_GUIDE.md (incorporated)
- CONTENT_ENHANCEMENT_SUMMARY.md (obsolete)
- CRITICAL_AUDIO_FIX.md (resolved)

---

## üöÄ FUTURE ENHANCEMENTS

**Phase 2 - Client Version (Post-HPSA)**
- Dashboard integration (in progress)
- Enhanced automation workflows
- Additional quality control checkpoints
- Client-specific customizations
- Value-add features for paying clients

**Current Focus:**
- ‚úÖ HPSA production deployment complete
- üîÑ Dashboard development ongoing
- üìã Client enhancement planning phase

---

## üìû SUPPORT

**Developer:** Carlorbiz
**Client:** GPSA/HPSA
**Purpose:** Australian healthcare education course development
**Version:** 1.0 - HPSA Production Release

---

**¬© 2025 Carlorbiz | Developed for GPSA/HPSA**
