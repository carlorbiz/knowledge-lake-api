# Google Apps Script - Course Development System

**Last Updated:** 2025-10-08
**Status:** Production Ready

---

## üìö ACTIVE SCRIPTS

### **1. Module_Content_Generator.gs**
**Purpose:** Automated module content generation
**Status:** ‚úÖ Production Ready (Enhanced with Phase A/B/C improvements)

**Features:**
- Pure Google stack (Gemini API only)
- Hybrid workflow: Manual research (Claude UI/Genspark/NotebookLM/Gems) ‚Üí Automated content generation
- Generates 12 slides with rich 100-150 word detailed content per slide
- Creates LMS upload document (Absorb AI compatible with exactly 12 screen structure)
- Generates premium workbook materials with glossary, templates, resources
- Creates 2-3 detailed case studies per module
- Produces assessments (10 MCQs + 3 role-play scenarios) with iSpring audio scripts
- Vancouver citations support (separate Citations column in Module Queue)
- Writes to Audio tab with Status="Pending" for enhancement

**Recent Enhancements (2025-10-08):**
- ‚úÖ Removed voiceover generation (handled by Audio tab)
- ‚úÖ Changed to rich detailedContent (100-150 words/slide) for quality downstream outputs
- ‚úÖ Fixed Absorb LMS AI slide alignment (explicit 12-screen structure)
- ‚úÖ Added Citations column support (Column M in Module Queue)
- ‚úÖ Optimized token usage (8192 max, temperature 0.7)
- ‚úÖ Enhanced error handling with JSON validation
- ‚úÖ Column mapping aligned with Audio_Tab_Enhanced.gs

**Workflow:**
1. User completes research manually (Claude UI/Genspark/etc.)
2. Pastes research into Research Notes column + Citations into Column M
3. Sets module Status = "Next" in Module Queue
4. Runs "Process 'Next' Module" from menu
5. Script generates all content and writes to Audio tab
6. User processes Audio tab enhancement + audio generation

---

### **2. Audio_Tab_Enhanced.gs**
**Purpose:** Slide enhancement and audio generation
**Status:** ‚úÖ Production Ready

**Features:**
- Reads raw slide content from Column R (detailed content from Module Generator)
- Enhances into:
  - Content Points (4-6 bullet points, Column M)
  - Voiceover Script (150-225 words with phonetic replacements, Column B)
  - Image Prompt (visual description, Column D)
- Generates audio using Gemini TTS with 30 voice options
- Phonetic replacement for Australian healthcare acronyms (ACRRM ‚Üí "Ackr'm", etc.)
- Real-time sheet updates with `SpreadsheetApp.flush()`
- Professional Australian voice prompts
- Status-based workflows: Pending ‚Üí Content Enhanced ‚Üí Audio Generated

**Phonetic Replacements:**
- ACRRM ‚Üí "Ackr'm"
- RACGP ‚Üí "R.A.C.G.P."
- AHPRA ‚Üí "Ah-pra"
- GPs ‚Üí "G.P.s"
- Number ranges: "3-5" ‚Üí "3 to 5"
- Day ranges: "Monday-Friday" ‚Üí "Monday to Friday"

**Workflows:**
- Process Next Slides (one-by-one)
- Full Pipeline (enhance + audio for selected range)
- Batch Audio Generation (audio only for enhanced slides)

---

## üìã ACTIVE DOCUMENTATION

### **AUDIO_TAB_INSTALLATION.md**
Installation guide for Audio_Tab_Enhanced.gs

### **SCRIPT_PROPERTIES_SETUP.md**
Configuration guide for API keys and settings

### **STATUS_WORKFLOW_GUIDE.md**
Status-based automation workflows

### **USER_GUIDE_QUICK_START.md**
Quick start guide for end users

### **CHANGELOG.md**
Version history and changes

### **Complete_Course_Development_Workflow.txt**
Full workflow specification from research to final output

### **Quick_Reference_All_Prompts_&_Templates.txt**
Prompt library for manual Gems/NotebookLM use

---

## üóÇÔ∏è COLUMN STRUCTURE

### **Module Queue Sheet**
- Module Number
- Module Title
- Audience Type
- Learning Objectives
- Core Content Focus
- Research Notes (body of research)
- **Citations** (Column M - Vancouver style citations)
- Status (Next ‚Üí Content Generated)
- Last Updated

### **Audio Tab (Master Workbook)**
- A: Slide # (1-12)
- B: Voiceover Script (generated by Audio tab)
- C: Audio File
- D: Image Prompt (generated by Audio tab)
- E: Image File
- F: Course ID
- G: Module Number
- H: Slide Number
- I: Module Title
- J: Course Title
- K: Target Audience
- L: Slide Title
- M: Content Points JSON (generated by Audio tab)
- N: Timestamp
- O: Status (Pending ‚Üí Content Enhanced ‚Üí Audio Generated)
- P: Voice Selection
- Q: Slides PPT
- R: Raw Slide Content (SOURCE - written by Module Generator)

### **Module Content Complete Sheet**
- Module Number
- Module Title
- Audience Type
- Learning Objectives
- Research Summary
- Slides JSON
- LMS Document
- Workbook Materials
- **Case Studies** (new)
- MCQs JSON
- Role-Play Scenarios JSON
- **Audio Scripts JSON** (new - iSpring compatible)
- Generated Date
- Audio Tab Link
- Status

---

## üîÑ COMPLETE WORKFLOW

```
1. Research (Manual)
   ‚Üì
   User completes via Claude UI/Genspark/NotebookLM/Gems
   Pastes into Research Notes + Citations columns

2. Module Content Generation (Automated)
   ‚Üì
   Module_Content_Generator.gs
   - Generates 12 slides (detailedContent 100-150 words each)
   - Creates LMS upload (Absorb AI compatible)
   - Creates premium workbook + case studies
   - Creates assessments + iSpring audio scripts
   - Writes to Audio tab (Status: Pending)

3. Audio Tab Enhancement (Automated)
   ‚Üì
   Audio_Tab_Enhanced.gs
   - Reads Column R (raw content)
   - Generates content points, voiceover, image prompt
   - Applies phonetic replacements
   - Writes to Columns B, D, M
   - Status: Content Enhanced

4. Audio Generation (Automated)
   ‚Üì
   Audio_Tab_Enhanced.gs
   - Reads Column B (voiceover script)
   - Generates audio with Gemini TTS
   - Uploads to Google Drive
   - Status: Audio Generated

5. Absorb LMS Upload (Manual)
   ‚Üì
   User uploads LMS document to Absorb
   Absorb AI creates exactly 12 screens matching slides
   User adds audio files to each screen
   Publishes course
```

---

## üéØ KEY DESIGN DECISIONS

### **Separation of Concerns**
- **Module Generator:** Creates educational content structure
- **Audio Tab:** Optimizes content for presentation and audio

### **Hybrid Workflow**
- Manual research (quality control, expertise)
- Automated content generation (efficiency, consistency)

### **Pure Google Stack**
- Gemini API for all AI operations
- Google Drive for file storage
- Google Sheets for data management
- No external AI services (Anthropic, OpenAI, etc.)

### **Australian Healthcare Focus**
- AHPRA, NMBA, NSQHS standards compliance
- Australian spelling throughout
- Professional tone for experienced practitioners
- Evidence-based content with Vancouver citations

### **Absorb LMS Compatibility**
- Explicit 12-screen structure in LMS document
- Markdown formatting for AI parsing
- Voiceover files align with course screens

---

## üì¶ ARCHIVED (2025-10-08)

Moved to `archive_2025-10-08/`:
- Audio_Tab_Complete.gs (superseded by Audio_Tab_Enhanced.gs)
- MODULE_GENERATOR_REVIEW.md (enhancements completed)
- CONTENT_ENHANCEMENT_GUIDE.md (incorporated into current scripts)
- CONTENT_ENHANCEMENT_SUMMARY.md (obsolete)
- CRITICAL_AUDIO_FIX.md (issues resolved)

---

## üöÄ NEXT STEPS

1. Test Module_Content_Generator.gs with new 100-150 word content length
2. Verify JSON generation completes successfully
3. Check Absorb AI parses 12 screens correctly
4. Confirm voiceover alignment after upload
5. Generate remaining course modules

---

**For detailed implementation notes, see:** `carla-claude-conversations.txt`
