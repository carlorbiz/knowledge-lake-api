# ðŸ”„ MODIFIED EXISTING WORKFLOWS

## ðŸ”Š AUDIO GENERATION WORKFLOW MODIFICATIONS

### **Current Workflow Changes:**
Replace webhook trigger with Sheets trigger, modify data flow for user control

### **Modified Sheet Structure:**
```
Sheet Name: "Audio Generation"
Col A: Slide Content (User pastes/types slide content)
Col B: Prepared Audio Script (Generated by existing OpenAI node)
Col C: Audio File Link (Generated by existing Gemini/Apps Script nodes)
Col D: Upload Confirmation (User checkbox)
Col E: Voice Type (Dropdown: Charon, Orus, Kore, Aoede)
Col F: Module Name (User input)
```

### **Node Modifications:**

#### **Replace Node 1: Webhook â†’ Google Sheets Trigger**
```javascript
// OLD: Webhook trigger from full workflow
// NEW: Google Sheets trigger
{
  "trigger": "Google Sheets",
  "watchFor": "Row Updates",
  "column": "A",
  "condition": "Col A has content AND Col B is empty"
}
```

#### **Modify Node 2: Data Processing**
```javascript
// OLD: Extract from webhook payload
// NEW: Extract from Sheets row
const slideContent = $json["Col A"];
const voiceType = $json["Col E"] || "Charon";
const moduleName = $json["Col F"] || "Module";

// Update processing status
await $sheets.update({
  range: `B${rowNumber}`,
  values: [["Processing..."]]
});
```

#### **Keep Existing Nodes 3-5:**
- **Node 3**: OpenAI script generation (same logic)
- **Node 4**: Apps Script audio generation call (same logic)
- **Node 5**: Update results to sheet (modify to write to Cols B & C)

#### **Add Node 6: Module Completion Check**
```javascript
// Check if all rows in current module have Col C filled
// If complete module: Send notification
// User can then batch-check Col D when uploaded to LMS
```

---

## ðŸ”¬ RESEARCH FOUNDATION WORKFLOW MODIFICATIONS

### **Current Workflow Changes:**
Replace form/webhook trigger with Sheets trigger, output to Google Doc instead of continuing to course generation

### **Modified Sheet Structure:**
```
Sheet Name: "Research Foundation"
Col A: Course Concept + URLs (User input)
Col B: Target Audience (Dropdown: Healthcare Clinical, Executive, Management, Operational)
Col C: Processing Status (Auto-updated)
Col D: Research Foundation Doc (Google Doc link)
Col E: Completion Timestamp
```

### **Node Modifications:**

#### **Replace Node 1: Form/Webhook â†’ Google Sheets Trigger**
```javascript
// OLD: Google Form webhook trigger
// NEW: Google Sheets trigger
{
  "trigger": "Google Sheets",
  "watchFor": "Row Updates",
  "column": "A",
  "condition": "Col A has content AND Col D is empty"
}
```

#### **Modify Node 2: Data Setup**
```javascript
// OLD: Extract from form submission
// NEW: Extract from Sheets row
const courseConcept = $json["Col A"];
const targetAudience = $json["Col B"] || "Healthcare Clinical";

// Update status
await $sheets.update({
  range: `C${rowNumber}`,
  values: [["Researching..."]]
});
```

#### **Keep Existing Nodes 3-4:**
- **Node 3**: Perplexity research call (same sophisticated prompts)
- **Node 4**: Knowledge Lake research foundation generation (same logic)

#### **Replace Node 5: Course Generation â†’ Google Doc Creation**
```javascript
// OLD: Continue to course architect
// NEW: Create Google Doc with research output
const docContent = researchFoundation;

const doc = await $googleDocs.create({
  title: `Research Foundation - ${courseConcept}`,
  content: docContent
});

// Update sheet with doc link
await $sheets.update({
  range: `D${rowNumber}:E${rowNumber}`,
  values: [[doc.url, new Date().toISOString()]]
});
```

---

## ðŸ“‹ COURSE ORCHESTRATOR MODIFICATION

### **Modified Sheet Structure:**
```
Sheet Name: "Course Generation"
Col A: Research Foundation Content (User pastes from Research Doc or manual input)
Col B: Generated Slides (Auto-populated)
Col C: Learning Objectives (Auto-populated)
Col D: Key Concepts (Auto-populated)
Col E: LMS Upload Doc (Google Doc link)
Col F: Module Number (User specifies)
Col G: Target Audience (User input)
Col H: Processing Status
```

### **Key Modifications:**

#### **Node 1: Sheets Trigger**
```javascript
{
  "trigger": "Google Sheets",
  "watchFor": "Row Updates",
  "column": "A",
  "condition": "Col A has content AND Col E is empty"
}
```

#### **Node 2-4: Use Existing Course Architect Logic**
- Keep existing sophisticated prompts
- Modify to work with user-provided research foundation
- Generate slides, objectives, key concepts separately

#### **Node 5: Create LMS Upload Document**
```javascript
// Combine B, C, D into comprehensive LMS document
// Create Google Doc with professional formatting
// Link in Col E
```

---

## ðŸ”§ IMPLEMENTATION APPROACH

### **Workflow Modifications Priority:**

1. **Audio Generation** (Easiest - just change trigger and I/O)
2. **Research Foundation** (Medium - change trigger, add Doc creation)
3. **Course Orchestrator** (More complex - restructure data flow)

### **Existing Nodes to Preserve:**
- âœ… **Perplexity Research Integration**
- âœ… **Knowledge Lake API Calls**
- âœ… **OpenAI/Anthropic Sophisticated Prompts**
- âœ… **Apps Script Audio Generation**
- âœ… **Error Handling and Notifications**

### **New Components Needed:**
- ðŸ†• **Google Sheets Triggers** (replace webhooks)
- ðŸ†• **Google Docs API Integration** (for output documents)
- ðŸ†• **Status Tracking in Sheets** (user visibility)

This approach preserves all your sophisticated AI orchestration while giving users granular control over each component. Much more efficient than rebuilding from scratch!