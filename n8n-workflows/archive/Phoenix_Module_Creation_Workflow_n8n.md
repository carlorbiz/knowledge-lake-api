# PHOENIX MODULE CREATION WORKFLOW - N8N IMPLEMENTATION
## Research Foundation → Course Architecture → Module Generation → Premium Content Creation

### WORKFLOW OVERVIEW
Complete Phoenix module creation workflow triggered by uploaded Research Foundation. Uses premium upgraded prompts to generate sophisticated course modules with professional slides, assessments, audio scripts, and LMS-ready content.

---

## GOOGLE FORMS & SHEETS STRUCTURE

### Google Forms Configuration:
**Form Fields:**
1. **Course Concept** (Short answer)
2. **Audience Type** (Multiple choice) - Healthcare Clinical, Operational Staff, Management, Leadership
3. **Research Foundation Upload** (File upload) - PDF research foundation document
4. **Additional URLs** (Paragraph) - List of additional reference URLs if >10 file limit

### Google Sheets Structure:
**Form responses 2 (Phoenix Course Requests):**
- Column A: Timestamp
- Column B: Email address (Google email auto entry, required for file upload)
- Column C: Course Concept
- Column D: Research Foundation (Google Drive file link)
- Column E: Audience Type
- Column F: Voice Selection
- Column G: User Email
- Column H: User Name
- Column I: Course ID (generated by workflow)
- Column J: Status (generated by workflow)
- Column K: Recommendation Doc (generated by workflow)

---

## N8N WORKFLOW STRUCTURE

### 1. GOOGLE SHEETS TRIGGER
**Node Type**: Google Sheets Trigger
**Configuration**:
- **Spreadsheet**: Phoenix Course Generation Master Sheet
- **Sheet**: Form responses 2
- **Event**: On Row Added
- **Columns to Monitor**: C (Course Concept), D (Research Foundation), E (Audience Type), F (Voice Selection)

---

### 2. SET INITIAL CONTEXT
**Node Type**: Set
**Variables to Set**:
```javascript
course_id = "course_" + new Date().toISOString().replace(/[-:]/g, '').substring(0, 15)
processing_timestamp = new Date().toISOString()
course_concept = {{ $json["Course Concept"] }}
target_audience = {{ $json["Audience Type"] }}
research_foundation = {{ $json["Research Foundation"] }}
voice_selection = {{ $json["Voice Selection"] }}
user_name = {{ $json["User Name"] }}
user_email = {{ $json["User Email"] }}
sheet_row = {{ $node["Google Sheets Trigger"].json["row_number"] }}
```

---

### 3. COURSE ARCHITECTURE GENERATION
**Node Type**: HTTP Request
**Method**: POST
**URL**: `http://localhost:5001/course-architect-from-research`

**Body**:
```json
{
  "course_concept": "{{ $json.course_concept }}",
  "target_audience": "{{ $json.target_audience }}",
  "research_foundation": "{{ $json.research_foundation }}",
  "voice_selection": "{{ $json.voice_selection }}",
  "user_name": "{{ $json.user_name }}",
  "user_email": "{{ $json.user_email }}"
}
```

---

### 5. MODULE GENERATION LOOP
**Node Type**: Split in Batches
**Purpose**: Generate each module individually using premium prompts

**Configuration**:
- **Batch Size**: 1 (generate one module at a time)
- **Input Data**: {{ $node['Course Architecture Generation'].json.modules }}

---

### 6. INDIVIDUAL MODULE CREATION
**Node Type**: HTTP Request
**Method**: POST
**URL**: `http://localhost:5001/module/generate-premium`

**Body**:
```json
{
  "module_number": "{{ $json.module_number }}",
  "module_title": "{{ $json.module_title }}",
  "learning_objectives": "{{ $json.learning_objectives }}",
  "course_concept": "{{ $parent.course_concept }}",
  "audience_type": "{{ $parent.audience_type }}",
  "research_foundation": "{{ $node['Download Research Foundation'].json.content }}",
  "course_architecture": "{{ $node['Course Architecture Generation'].json.course_architecture }}",
  "premium_components": [
    "professional_slides",
    "enhanced_audio_script",
    "sophisticated_assessment",
    "interactive_role_play",
    "professional_resources",
    "lms_upload_text"
  ]
}
```

---

### 7. PROFESSIONAL SLIDES GENERATION
**Node Type**: HTTP Request
**Method**: POST
**URL**: `http://localhost:5001/slides/generate-professional`

**Body**:
```json
{
  "module_content": "{{ $node['Individual Module Creation'].json.module_content }}",
  "module_title": "{{ $json.module_title }}",
  "learning_objectives": "{{ $json.learning_objectives }}",
  "audience_type": "{{ $parent.audience_type }}",
  "slide_count": 15,
  "include_presenter_notes": true,
  "australian_context": true
}
```

---

### 8. ENHANCED AUDIO SCRIPT GENERATION
**Node Type**: HTTP Request
**Method**: POST
**URL**: `http://localhost:5001/audio/generate-enhanced`

**Body**:
```json
{
  "module_content": "{{ $node['Individual Module Creation'].json.module_content }}",
  "slide_content": "{{ $node['Professional Slides Generation'].json.slides }}",
  "voice_type": "professional",
  "duration_target": "15-20 minutes",
  "include_interactions": true,
  "australian_pronunciation": true
}
```

---

### 9. SOPHISTICATED ASSESSMENT GENERATION
**Node Type**: HTTP Request
**Method**: POST
**URL**: `http://localhost:5001/assessment/generate-sophisticated`

**Body**:
```json
{
  "module_content": "{{ $node['Individual Module Creation'].json.module_content }}",
  "learning_objectives": "{{ $json.learning_objectives }}",
  "audience_type": "{{ $parent.audience_type }}",
  "assessment_types": [
    "multiple_choice_advanced",
    "scenario_based",
    "case_study_analysis",
    "practical_application"
  ],
  "millers_pyramid_levels": ["knows", "knows_how", "shows_how", "does"],
  "australian_context": true
}
```

---

### 10. INTERACTIVE ROLE PLAY SCENARIOS
**Node Type**: HTTP Request
**Method**: POST
**URL**: `http://localhost:5001/roleplay/generate-interactive`

**Body**:
```json
{
  "module_content": "{{ $node['Individual Module Creation'].json.module_content }}",
  "learning_objectives": "{{ $json.learning_objectives }}",
  "audience_type": "{{ $parent.audience_type }}",
  "scenario_count": 3,
  "include_branching": true,
  "cultural_safety_focus": true
}
```

---

### 11. PROFESSIONAL RESOURCES GENERATION
**Node Type**: HTTP Request
**Method**: POST
**URL**: `http://localhost:5001/resources/generate-professional`

**Body**:
```json
{
  "module_content": "{{ $node['Individual Module Creation'].json.module_content }}",
  "audience_type": "{{ $parent.audience_type }}",
  "resource_types": [
    "quick_reference_cards",
    "checklists",
    "templates",
    "additional_reading",
    "professional_development_pathways"
  ],
  "australian_standards": true
}
```

---

### 12. LMS UPLOAD TEXT GENERATION
**Node Type**: HTTP Request
**Method**: POST
**URL**: `http://localhost:5001/lms/generate-upload-text`

**Body**:
```json
{
  "module_content": "{{ $node['Individual Module Creation'].json.module_content }}",
  "slide_content": "{{ $node['Professional Slides Generation'].json.slides }}",
  "assessment_content": "{{ $node['Sophisticated Assessment Generation'].json.assessments }}",
  "audio_script": "{{ $node['Enhanced Audio Script Generation'].json.script }}",
  "lms_platform": "absorb",
  "scorm_compliance": true
}
```

---

### 13. COMPILE MODULE PACKAGE
**Node Type**: Set
**Purpose**: Combine all generated components into complete module package

**Variables to Set**:
```javascript
complete_module = {
  module_number: {{ $json.module_number }},
  module_title: {{ $json.module_title }},
  learning_objectives: {{ $json.learning_objectives }},
  content: {{ $node['Individual Module Creation'].json.module_content }},
  slides: {{ $node['Professional Slides Generation'].json.slides }},
  audio_script: {{ $node['Enhanced Audio Script Generation'].json.script }},
  assessments: {{ $node['Sophisticated Assessment Generation'].json.assessments }},
  role_play_scenarios: {{ $node['Interactive Role Play Scenarios'].json.scenarios }},
  professional_resources: {{ $node['Professional Resources Generation'].json.resources }},
  lms_upload_text: {{ $node['LMS Upload Text Generation'].json.upload_text }},
  generated_timestamp: {{ $parent.processing_timestamp }}
}
```

---

### 14. STORE MODULE IN KNOWLEDGE LAKE
**Node Type**: HTTP Request
**Method**: POST
**URL**: `http://localhost:5001/knowledge/store`

**Body**:
```json
{
  "content": "{{ $json.complete_module }}",
  "metadata": {
    "type": "premium_module",
    "course_id": "{{ $parent.course_id }}",
    "course_concept": "{{ $parent.course_concept }}",
    "audience_type": "{{ $parent.audience_type }}",
    "module_number": "{{ $json.module_number }}",
    "module_title": "{{ $json.module_title }}",
    "workflow_step": "phoenix_premium_module",
    "components": [
      "professional_slides",
      "enhanced_audio_script",
      "sophisticated_assessment",
      "interactive_role_play",
      "professional_resources",
      "lms_upload_text"
    ]
  }
}
```

---

### 15. CREATE MODULE GOOGLE DOC
**Node Type**: HTTP Request (DocsAutomator)
**Method**: POST
**URL**: `https://api.docsautomator.co/api/create-document`

**Body**:
```json
{
  "template_id": "premium_module_template",
  "document_title": "{{ $parent.course_concept }} - Module {{ $json.module_number }}: {{ $json.module_title }}",
  "data": {
    "module_number": "{{ $json.module_number }}",
    "module_title": "{{ $json.module_title }}",
    "learning_objectives": "{{ $json.learning_objectives }}",
    "module_content": "{{ $node['Individual Module Creation'].json.module_content }}",
    "slides": "{{ $node['Professional Slides Generation'].json.slides }}",
    "audio_script": "{{ $node['Enhanced Audio Script Generation'].json.script }}",
    "assessments": "{{ $node['Sophisticated Assessment Generation'].json.assessments }}",
    "role_play_scenarios": "{{ $node['Interactive Role Play Scenarios'].json.scenarios }}",
    "professional_resources": "{{ $node['Professional Resources Generation'].json.resources }}",
    "lms_upload_text": "{{ $node['LMS Upload Text Generation'].json.upload_text }}",
    "course_id": "{{ $parent.course_id }}",
    "generation_date": "{{ $parent.processing_timestamp }}"
  }
}
```

---

### 16. UPDATE GOOGLE SHEETS WITH MODULE STATUS
**Node Type**: Google Sheets
**Operation**: Append
**Configuration**:
- **Spreadsheet**: Phoenix Course Generation Master Sheet
- **Sheet**: Form responses 2 (Module Status Tracking)

**Data to Append**:
```json
{
  "course_id": "{{ $parent.course_id }}",
  "module_number": "{{ $json.module_number }}",
  "module_title": "{{ $json.module_title }}",
  "google_doc_url": "{{ $node['Create Module Google Doc'].json['document_url'] }}",
  "knowledge_lake_id": "{{ $node['Store Module in Knowledge Lake'].json['id'] }}",
  "status": "Module Complete",
  "completion_timestamp": "{{ $parent.processing_timestamp }}",
  "components_generated": "6/6"
}
```

---

### 17. FINAL COURSE COMPILATION (AFTER ALL MODULES)
**Node Type**: HTTP Request
**Method**: POST
**URL**: `http://localhost:5001/course/compile-final`

**Condition**: {{ $json.all_modules_complete === true }}

**Body**:
```json
{
  "course_id": "{{ $parent.course_id }}",
  "course_concept": "{{ $parent.course_concept }}",
  "audience_type": "{{ $parent.audience_type }}",
  "total_modules": "{{ $parent.total_modules }}",
  "create_master_document": true,
  "generate_course_overview": true,
  "create_lms_package": true
}
```

---

## REQUIRED API ENDPOINTS

### 1. `/module/generate-premium`
Generates comprehensive module content using upgraded prompts from `KNOWLEDGE_LAKE_PROMPTS_UPGRADED.md`

### 2. `/slides/generate-professional`
Creates professional presentation slides with presenter notes

### 3. `/audio/generate-enhanced`
Generates sophisticated audio scripts with interactions

### 4. `/assessment/generate-sophisticated`
Creates advanced assessments using Miller's Pyramid

### 5. `/roleplay/generate-interactive`
Develops interactive role-play scenarios with branching

### 6. `/resources/generate-professional`
Creates professional resources and reference materials

### 7. `/lms/generate-upload-text`
Generates LMS-ready content and SCORM package text

### 8. `/course/compile-final`
Compiles all modules into final course package

---

## WORKFLOW ADVANTAGES

### Premium Content Generation:
1. **Professional Slides** - 15-slide presentations with presenter notes
2. **Enhanced Audio Scripts** - 15-20 minute professional narration
3. **Sophisticated Assessments** - Miller's Pyramid-based evaluation
4. **Interactive Role Plays** - Branching scenarios with cultural safety
5. **Professional Resources** - Quick reference cards, checklists, templates
6. **LMS Upload Text** - SCORM-compliant content packages

### Quality Assurance:
1. **Australian Healthcare Context** - AHPRA, NMBA, NSQHS alignment
2. **Evidence-Based Content** - Research foundation integration
3. **Professional Development Focus** - Experienced clinician targeting
4. **Cultural Safety Integration** - Diversity considerations throughout
5. **Regulatory Compliance** - Professional standards adherence

### Scalability:
1. **Modular Generation** - Each component created independently
2. **Error Recovery** - Individual module failure doesn't stop workflow
3. **Quality Control** - Each step validated before proceeding
4. **Resource Management** - Efficient API call distribution

This workflow transforms uploaded Research Foundations into complete, professional-grade course modules ready for LMS deployment!